<!DOCTYPE html>
<html lang="de" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <meta name="app-version" content="1.0.2" />
  <title>Raten OIDA - Cyberpunk Quiz Game</title>
  <meta name="description" content="Ein cyberpunkiges Quiz-Game mit √∂sterreichischem Charme. Rate Hauptst√§dte und Einwohnerzahlen, verdiene Sch√ºlling und knacke den Highscore!" />
  <meta name="theme-color" content="#0f172a" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://ochtii.github.io/Raten_oida/" />
  <meta property="og:title" content="Raten OIDA - Cyberpunk Quiz Game" />
  <meta property="og:description" content="Ein cyberpunkiges Quiz-Game mit √∂sterreichischem Charme. Rate Hauptst√§dte und Einwohnerzahlen!" />
  <meta property="og:image" content="https://ochtii.github.io/Raten_oida/og-image.png" />
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image" />
  <meta property="twitter:url" content="https://ochtii.github.io/Raten_oida/" />
  <meta property="twitter:title" content="Raten OIDA - Cyberpunk Quiz Game" />
  <meta property="twitter:description" content="Ein cyberpunkiges Quiz-Game mit √∂sterreichischem Charme. Rate Hauptst√§dte und Einwohnerzahlen!" />
  <meta property="twitter:image" content="https://ochtii.github.io/Raten_oida/og-image.png" />
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üéÆ</text></svg>" />
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlJhdGVuIE9JREEiLAogICJzaG9ydF9uYW1lIjogIk9JREEiLAogICJkZXNjcmlwdGlvbiI6ICJDeWJlcnB1bmsgUXVpeiBHYW1lIG1pdCDDlnN0ZXJyZWljaGlzY2hlbSBDaGFybWUiLAogICJzdGFydF91cmwiOiAiLi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiMwZjE3MmEiLAogICJ0aGVtZV9jb2xvciI6ICIjMGYxNzJhIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sLDxzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2aWV3Qm94PScwIDAgMTAwIDEwMCc+PHRleHQgeT0nMC45ZW0nIGZvbnQtc2l6ZT0nOTAnPvCfjq48L3RleHQ+PC9zdmc+IiwKICAgICAgInNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfQogIF0KfQ==" />
  
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            neon: '#72f5ff',
            magenta: '#ff2e88',
            cyber: '#0b1224',
            cyber2: '#0f172a',
            lime: '#9ef01a',
          },
          fontFamily: {
            display: ['"Orbitron"', 'sans-serif'],
            body: ['"Inter"', 'sans-serif'],
          },
          boxShadow: {
            glow: '0 0 25px rgba(114,245,255,0.35)',
            neon: '0 0 18px rgba(255,46,136,0.45)',
          },
          backgroundImage: {
            mesh: 'radial-gradient(circle at 20% 20%, rgba(114,245,255,0.15), transparent 25%), radial-gradient(circle at 80% 0%, rgba(255,46,136,0.15), transparent 30%), radial-gradient(circle at 50% 80%, rgba(158,240,26,0.12), transparent 35%)',
          }
        }
      }
    }
  </script>
  <style>
    body { font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    .noise::after {
      content: '';
      position: fixed;
      inset: 0;
      pointer-events: none;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="140" height="140" viewBox="0 0 140 140"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="3" stitchTiles="stitch" /></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.12" /></svg>');
      mix-blend-mode: soft-light;
    }
  </style>
</head>
<body class="bg-cyber2 text-slate-100 min-h-screen noise">
  <div id="root" class="relative"></div>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/framer-motion@11.2.6/dist/framer-motion.umd.js"></script>
  <script>
    // Service Worker Registration for Cache Busting
    if ('serviceWorker' in navigator) {
      const APP_VERSION = '1.0.2';
      const SW_CODE = `
        const CACHE_VERSION = '${APP_VERSION}';
        const CACHE_NAME = 'raten-oida-v' + CACHE_VERSION;
        const urlsToCache = [
          './',
          './index.html'
        ];

        self.addEventListener('install', (event) => {
          event.waitUntil(
            caches.open(CACHE_NAME).then((cache) => {
              return cache.addAll(urlsToCache);
            }).then(() => self.skipWaiting())
          );
        });

        self.addEventListener('activate', (event) => {
          event.waitUntil(
            caches.keys().then((cacheNames) => {
              return Promise.all(
                cacheNames.map((cacheName) => {
                  if (cacheName.startsWith('raten-oida-') && cacheName !== CACHE_NAME) {
                    console.log('[SW] Deleting old cache:', cacheName);
                    return caches.delete(cacheName);
                  }
                })
              );
            }).then(() => self.clients.claim())
          );
        });

        self.addEventListener('fetch', (event) => {
          const url = new URL(event.request.url);
          
          // Skip CDN resources and use network
          if (url.hostname.includes('unpkg.com') || url.hostname.includes('googleapis.com') || url.hostname.includes('gstatic.com')) {
            event.respondWith(fetch(event.request));
            return;
          }

          // Network-first strategy for HTML to ensure latest version
          if (event.request.mode === 'navigate' || event.request.destination === 'document') {
            event.respondWith(
              fetch(event.request)
                .then((response) => {
                  const responseToCache = response.clone();
                  caches.open(CACHE_NAME).then((cache) => {
                    cache.put(event.request, responseToCache);
                  });
                  return response;
                })
                .catch(() => caches.match(event.request))
            );
          } else {
            // Cache-first for other resources
            event.respondWith(
              caches.match(event.request).then((response) => {
                return response || fetch(event.request);
              })
            );
          }
        });
      `;

      const blob = new Blob([SW_CODE], { type: 'application/javascript' });
      const swUrl = URL.createObjectURL(blob);

      navigator.serviceWorker.register(swUrl).then((registration) => {
        console.log('[App] Service Worker registered, version:', APP_VERSION);
        
        // Check for updates every 60 seconds
        setInterval(() => {
          registration.update();
        }, 60000);

        // Listen for updates
        registration.addEventListener('updatefound', () => {
          const newWorker = registration.installing;
          newWorker.addEventListener('statechange', () => {
            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
              console.log('[App] New version available, reloading...');
              window.location.reload();
            }
          });
        });
      }).catch((error) => {
        console.warn('[App] Service Worker registration failed:', error);
      });

      // Force reload on version mismatch
      const storedVersion = localStorage.getItem('raten_oida_app_version');
      if (storedVersion && storedVersion !== APP_VERSION) {
        console.log('[App] Version changed from', storedVersion, 'to', APP_VERSION);
        localStorage.setItem('raten_oida_app_version', APP_VERSION);
        caches.keys().then((names) => {
          names.forEach((name) => {
            if (name.startsWith('raten-oida-')) caches.delete(name);
          });
        });
        window.location.reload(true);
      } else {
        localStorage.setItem('raten_oida_app_version', APP_VERSION);
      }
    }
  </script>
  <script>
    (() => {
      const { useState, useEffect, useMemo, useRef } = React;
      const { motion, AnimatePresence } = window['framer-motion'];

      const STORAGE_KEYS = {
        THEME: 'raten_oida_theme',
        ECONOMY: 'raten_oida_economy',
        SETTINGS: 'raten_oida_settings',
        STATS: 'raten_oida_stats',
      };

      const defaultEconomy = { balance: 500, tipsBought: 0, highscore: 0 };
      const defaultSettings = { bottomNavVisible: true, bottomNavScale: 1, timeLimit: 30, difficulty: 'normal', themeMode: 'auto' };
      const defaultStats = { gamesPlayed: 0, wins: 0, timeBonus: 0, lastWin: null };

      const capitals = [
        { country: '√ñsterreich', capital: 'Wien', region: 'EU', flag: 'üá¶üáπ' },
        { country: 'Deutschland', capital: 'Berlin', region: 'EU', flag: 'üá©üá™' },
        { country: 'Schweiz', capital: 'Bern', region: 'EU', flag: 'üá®üá≠' },
        { country: 'Frankreich', capital: 'Paris', region: 'EU', flag: 'üá´üá∑' },
        { country: 'Italien', capital: 'Rom', region: 'EU', flag: 'üáÆüáπ' },
        { country: 'Spanien', capital: 'Madrid', region: 'EU', flag: 'üá™üá∏' },
        { country: 'Portugal', capital: 'Lissabon', region: 'EU', flag: 'üáµüáπ' },
        { country: 'Belgien', capital: 'Br√ºssel', region: 'EU', flag: 'üáßüá™' },
        { country: 'Niederlande', capital: 'Amsterdam', region: 'EU', flag: 'üá≥üá±' },
        { country: 'D√§nemark', capital: 'Kopenhagen', region: 'EU', flag: 'üá©üá∞' },
        { country: 'Norwegen', capital: 'Oslo', region: 'EU', flag: 'üá≥üá¥' },
        { country: 'Schweden', capital: 'Stockholm', region: 'EU', flag: 'üá∏üá™' },
        { country: 'Finnland', capital: 'Helsinki', region: 'EU', flag: 'üá´üáÆ' },
        { country: 'Polen', capital: 'Warschau', region: 'EU', flag: 'üáµüá±' },
        { country: 'Tschechien', capital: 'Prag', region: 'EU', flag: 'üá®üáø' },
        { country: 'Slowakei', capital: 'Bratislava', region: 'EU', flag: 'üá∏üá∞' },
        { country: 'Ungarn', capital: 'Budapest', region: 'EU', flag: 'üá≠üá∫' },
        { country: 'Griechenland', capital: 'Athen', region: 'EU', flag: 'üá¨üá∑' },
        { country: 'Irland', capital: 'Dublin', region: 'EU', flag: 'üáÆüá™' },
        { country: 'Kroatien', capital: 'Zagreb', region: 'EU', flag: 'üá≠üá∑' },
        { country: 'Serbien', capital: 'Belgrad', region: 'EU', flag: 'üá∑üá∏' },
        { country: 'Rum√§nien', capital: 'Bukarest', region: 'EU', flag: 'üá∑üá¥' },
        { country: 'Bulgarien', capital: 'Sofia', region: 'EU', flag: 'üáßüá¨' },
        { country: 'T√ºrkei', capital: 'Ankara', region: 'EU', flag: 'üáπüá∑' },
        { country: 'USA', capital: 'Washington D.C.', region: 'WORLD', flag: 'üá∫üá∏' },
        { country: 'Kanada', capital: 'Ottawa', region: 'WORLD', flag: 'üá®üá¶' },
        { country: 'Brasilien', capital: 'Bras√≠lia', region: 'WORLD', flag: 'üáßüá∑' },
        { country: 'Argentinien', capital: 'Buenos Aires', region: 'WORLD', flag: 'üá¶üá∑' },
        { country: 'Japan', capital: 'Tokio', region: 'WORLD', flag: 'üáØüáµ' },
        { country: 'China', capital: 'Peking', region: 'WORLD', flag: 'üá®üá≥' },
        { country: 'Australien', capital: 'Canberra', region: 'WORLD', flag: 'üá¶üá∫' },
        { country: 'Neuseeland', capital: 'Wellington', region: 'WORLD', flag: 'üá≥üáø' },
        { country: 'S√ºdafrika', capital: 'Pretoria', region: 'WORLD', flag: 'üáøüá¶' },
        { country: '√Ñgypten', capital: 'Kairo', region: 'WORLD', flag: 'üá™üá¨' },
        { country: 'Indien', capital: 'Neu-Delhi', region: 'WORLD', flag: 'üáÆüá≥' },
        { country: 'Indonesien', capital: 'Jakarta', region: 'WORLD', flag: 'üáÆüá©' },
        { country: 'Mexiko', capital: 'Mexiko-Stadt', region: 'WORLD', flag: 'üá≤üáΩ' },
        { country: 'Vereinigtes K√∂nigreich', capital: 'London', region: 'EU', flag: 'üá¨üáß' }
      ];

      const populations = [
        { name: '√ñsterreich', type: 'country', population: 9000000, area: 83879, flag: 'üá¶üáπ' },
        { name: 'Wien', type: 'city', population: 1900000, area: 414, flag: 'üá¶üáπ' },
        { name: 'Deutschland', type: 'country', population: 83000000, area: 357022, flag: 'üá©üá™' },
        { name: 'Berlin', type: 'city', population: 3700000, area: 891, flag: 'üá©üá™' },
        { name: 'Frankreich', type: 'country', population: 67000000, area: 643801, flag: 'üá´üá∑' },
        { name: 'Paris', type: 'city', population: 2140000, area: 105, flag: 'üá´üá∑' },
        { name: 'Italien', type: 'country', population: 60000000, area: 301340, flag: 'üáÆüáπ' },
        { name: 'Rom', type: 'city', population: 2873000, area: 1287, flag: 'üáÆüáπ' },
        { name: 'Spanien', type: 'country', population: 47000000, area: 505990, flag: 'üá™üá∏' },
        { name: 'Madrid', type: 'city', population: 3223000, area: 604, flag: 'üá™üá∏' },
        { name: 'Polen', type: 'country', population: 38000000, area: 312696, flag: 'üáµüá±' },
        { name: 'Warschau', type: 'city', population: 1790000, area: 517, flag: 'üáµüá±' },
        { name: 'USA', type: 'country', population: 331000000, area: 9833520, flag: 'üá∫üá∏' },
        { name: 'New York City', type: 'city', population: 8419000, area: 783, flag: 'üá∫üá∏' },
        { name: 'Kanada', type: 'country', population: 38000000, area: 9984670, flag: 'üá®üá¶' },
        { name: 'Toronto', type: 'city', population: 2930000, area: 630, flag: 'üá®üá¶' },
        { name: 'Japan', type: 'country', population: 125800000, area: 377975, flag: 'üáØüáµ' },
        { name: 'Tokio', type: 'city', population: 13960000, area: 2191, flag: 'üáØüáµ' },
        { name: 'Australien', type: 'country', population: 25700000, area: 7692024, flag: 'üá¶üá∫' },
        { name: 'Sydney', type: 'city', population: 5312000, area: 12367, flag: 'üá¶üá∫' },
        { name: 'Brasilien', type: 'country', population: 212000000, area: 8515767, flag: 'üáßüá∑' },
        { name: 'S√£o Paulo', type: 'city', population: 12330000, area: 1521, flag: 'üáßüá∑' },
        { name: 'S√ºdafrika', type: 'country', population: 59300000, area: 1221037, flag: 'üáøüá¶' },
        { name: 'Kapstadt', type: 'city', population: 4337000, area: 2460, flag: 'üáøüá¶' },
        { name: '√Ñgypten', type: 'country', population: 102000000, area: 1002450, flag: 'üá™üá¨' },
        { name: 'Kairo', type: 'city', population: 9900000, area: 606, flag: 'üá™üá¨' },
        { name: 'Mexiko', type: 'country', population: 128900000, area: 1964375, flag: 'üá≤üáΩ' },
        { name: 'Mexiko-Stadt', type: 'city', population: 9200000, area: 1495, flag: 'üá≤üáΩ' }
      ];

      const readLS = (key, fallback) => {
        try {
          const raw = localStorage.getItem(key);
          return raw ? JSON.parse(raw) : fallback;
        } catch (e) {
          console.warn('ls read fail', e);
          return fallback;
        }
      };
      const writeLS = (key, value) => {
        try { localStorage.setItem(key, JSON.stringify(value)); } catch (e) { console.warn('ls write fail', e); }
      };

      const shuffle = (arr) => {
        const a = [...arr];
        for (let i = a.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [a[i], a[j]] = [a[j], a[i]];
        }
        return a;
      };

      const randomItem = (arr) => arr[Math.floor(Math.random() * arr.length)];

      const currency = (num) => `${num.toLocaleString('de-AT')} Sch√ºlling`;

      const Badge = ({ children }) => (
        <span className="px-2 py-1 text-xs rounded-full bg-cyan-500/10 border border-cyan-400/40 text-cyan-100">{children}</span>
      );

      const Section = ({ title, children, id }) => (
        <section id={id} className="mb-8">
          <div className="flex items-center gap-3 mb-3">
            <div className="w-1.5 h-6 rounded-full bg-gradient-to-b from-neon to-magenta shadow-neon"></div>
            <h2 className="text-xl font-display tracking-tight text-white">{title}</h2>
          </div>
          <div className="bg-slate-900/60 border border-white/10 rounded-2xl shadow-glow p-4 backdrop-blur">
            {children}
          </div>
        </section>
      );

      const GameCard = ({ title, subtitle, accent, onStart, pills }) => (
        <div className="bg-slate-800/70 border border-white/10 rounded-2xl p-4 flex flex-col gap-3 shadow-glow">
          <div className="flex items-center justify-between">
            <div>
              <h3 className="text-lg font-display text-white">{title}</h3>
              <p className="text-sm text-slate-300">{subtitle}</p>
            </div>
            <span className="px-3 py-1 text-xs rounded-full bg-gradient-to-r from-neon to-magenta text-slate-900 font-semibold shadow-glow">{accent}</span>
          </div>
          <div className="flex flex-wrap gap-2">{pills?.map((p) => <Badge key={p}>{p}</Badge>)}</div>
          <button onClick={onStart} className="mt-2 inline-flex items-center justify-center gap-2 px-4 py-2 rounded-xl bg-gradient-to-r from-neon to-magenta text-slate-900 font-semibold shadow-neon">
            üöÄ Spiel starten
          </button>
        </div>
      );

      const useTheme = () => {
        const [theme, setTheme] = useState(() => readLS(STORAGE_KEYS.THEME, defaultSettings.themeMode));
        const [systemPref, setSystemPref] = useState(() => window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');

        useEffect(() => {
          const mq = window.matchMedia('(prefers-color-scheme: dark)');
          const handler = (e) => setSystemPref(e.matches ? 'dark' : 'light');
          mq.addEventListener('change', handler);
          return () => mq.removeEventListener('change', handler);
        }, []);

        const resolved = theme === 'auto' ? systemPref : theme;

        useEffect(() => {
          const html = document.documentElement;
          if (resolved === 'dark') html.classList.add('dark'); else html.classList.remove('dark');
          writeLS(STORAGE_KEYS.THEME, theme);
        }, [resolved, theme]);

        return { theme, setTheme, resolved };
      };

      const TipButton = ({ label, cost, onClick, disabled }) => (
        <button
          disabled={disabled}
          onClick={onClick}
          className={`text-xs px-3 py-2 rounded-lg border transition ${disabled ? 'opacity-40 cursor-not-allowed' : 'hover:-translate-y-0.5'} bg-slate-800/80 border-cyan-400/30 text-cyan-100`}
        >
          {label} ¬∑ {cost} Sch√ºlling
        </button>
      );

      const Modal = ({ open, onClose, children, title }) => (
        <AnimatePresence>
          {open && (
            <motion.div
              className="fixed inset-0 z-40 flex items-center justify-center"
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              <div className="absolute inset-0 bg-black/60 backdrop-blur" onClick={onClose}></div>
              <motion.div
                initial={{ y: 30, opacity: 0, scale: 0.96 }}
                animate={{ y: 0, opacity: 1, scale: 1 }}
                exit={{ y: 30, opacity: 0, scale: 0.96 }}
                className="relative z-10 w-[min(94vw,680px)] bg-slate-900 border border-white/10 rounded-2xl shadow-2xl p-6"
              >
                <div className="flex items-center justify-between mb-4">
                  <h3 className="text-lg font-display text-white">{title}</h3>
                  <button onClick={onClose} className="text-slate-300 hover:text-white">Na oida ‚úñ</button>
                </div>
                {children}
              </motion.div>
            </motion.div>
          )}
        </AnimatePresence>
      );

      const BurgerMenu = ({ open, setOpen, items }) => (
        <div className="relative">
          <button
            onClick={() => setOpen((v) => !v)}
            className="p-3 rounded-xl bg-slate-900/80 border border-white/10 text-white shadow-glow"
            aria-label="Navigation √∂ffnen"
            aria-expanded={open}
          >
            <span className="block w-6 h-0.5 bg-white mb-1"></span>
            <span className="block w-6 h-0.5 bg-white mb-1"></span>
            <span className="block w-6 h-0.5 bg-white"></span>
          </button>
          <AnimatePresence>
            {open && (
              <motion.div
                initial={{ opacity: 0, y: -10 }}
                animate={{ opacity: 1, y: 0 }}
                exit={{ opacity: 0, y: -10 }}
                className="absolute mt-2 w-56 bg-slate-900 border border-white/10 rounded-2xl p-3 shadow-2xl"
              >
                {items.map((item) => (
                  <button
                    key={item.label}
                    onClick={() => { item.onClick?.(); setOpen(false); }}
                    className="w-full text-left px-3 py-2 rounded-lg hover:bg-white/5 text-white flex items-center gap-2"
                  >
                    <span>{item.icon}</span>
                    <span>{item.label}</span>
                  </button>
                ))}
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );

      const Logo = () => (
        <motion.div
          initial={{ opacity: 0, y: -20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.8 }}
          className="flex flex-col items-start"
        >
          <div className="text-sm text-cyan-200">Raten</div>
          <div className="text-3xl md:text-4xl font-display text-white tracking-tight">
            <span className="bg-gradient-to-r from-neon to-magenta bg-clip-text text-transparent">OIDA</span>
          </div>
        </motion.div>
      );

      const CapitalTips = ({ applyTip, balance }) => {
        const tips = [
          { key: 'fifty', label: '50/50 Joker', cost: 30 },
          { key: 'strike', label: 'Einen wegstreichen', cost: 20 },
          { key: 'coat', label: 'Wappen zeigen', cost: 15 },
          { key: 'first', label: 'Erster Buchstabe', cost: 10 },
          { key: 'last', label: 'Letzter Buchstabe', cost: 10 },
          { key: 'len', label: 'L√§nge vom Wort', cost: 12 },
        ];
        return (
          <div className="flex flex-wrap gap-2 mt-2">
            {tips.map((t) => (
              <TipButton key={t.key} label={t.label} cost={t.cost} disabled={balance < t.cost} onClick={() => applyTip(t)} />
            ))}
          </div>
        );
      };

      const PopulationTips = ({ applyTip, balance }) => {
        const tips = [
          { key: 'area', label: 'Fl√§che (km¬≤)', cost: 15 },
          { key: 'blindpop', label: 'Einwohnerzahl (blind)', cost: 18 },
        ];
        return (
          <div className="flex flex-wrap gap-2 mt-2">
            {tips.map((t) => (
              <TipButton key={t.key} label={t.label} cost={t.cost} disabled={balance < t.cost} onClick={() => applyTip(t)} />
            ))}
          </div>
        );
      };

      const BottomNav = ({ visible, scale, onNavigate }) => (
        <AnimatePresence>
          {visible && (
            <motion.nav
              initial={{ y: 30, opacity: 0 }}
              animate={{ y: 0, opacity: 1 }}
              exit={{ y: 30, opacity: 0 }}
              className="fixed bottom-4 inset-x-0 flex justify-center z-30"
            >
              <div
                style={{ transform: `scale(${scale})` }}
                className="bg-slate-900/90 border border-white/10 rounded-2xl shadow-2xl px-4 py-3 flex gap-4 text-white"
              >
                {[{ key: 'home', label: 'Home', icon: 'üè†' }, { key: 'games', label: 'Spiele', icon: 'üéÆ' }, { key: 'stats', label: 'Stats', icon: 'üìä' }, { key: 'settings', label: 'Settings', icon: '‚öôÔ∏è' }].map((item) => (
                  <button key={item.key} onClick={() => onNavigate(item.key)} className="flex flex-col items-center text-xs hover:text-neon">
                    <span className="text-lg">{item.icon}</span>
                    <span>{item.label}</span>
                  </button>
                ))}
              </div>
            </motion.nav>
          )}
        </AnimatePresence>
      );

      const ErrorBoundary = ({ children }) => {
        const [hasError, setHasError] = React.useState(false);
        
        React.useEffect(() => {
          const handler = (event) => {
            console.error('Error caught:', event.error);
            setHasError(true);
          };
          window.addEventListener('error', handler);
          return () => window.removeEventListener('error', handler);
        }, []);
        
        if (hasError) {
          return (
            <div className="min-h-screen bg-cyber2 flex items-center justify-center p-4">
              <div className="bg-slate-900 border border-red-500 rounded-2xl p-6 max-w-md text-center">
                <div className="text-6xl mb-4">‚ö†Ô∏è</div>
                <h1 className="text-2xl font-display text-white mb-2">Na oida!</h1>
                <p className="text-slate-300 mb-4">Es ist ein Fehler aufgetreten.</p>
                <button onClick={() => window.location.reload()} className="px-4 py-2 rounded-xl bg-gradient-to-r from-neon to-magenta text-slate-900 font-semibold">
                  Neu laden
                </button>
              </div>
            </div>
          );
        }
        
        return children;
      };

      function App() {
        const { theme, setTheme, resolved } = useTheme();
        const [isLoading, setIsLoading] = React.useState(true);
        const [economy, setEconomy] = useState(() => readLS(STORAGE_KEYS.ECONOMY, defaultEconomy));
        const [settings, setSettings] = useState(() => readLS(STORAGE_KEYS.SETTINGS, defaultSettings));
        const [stats, setStats] = useState(() => readLS(STORAGE_KEYS.STATS, defaultStats));
        const [burgerOpen, setBurgerOpen] = useState(false);
        const [page, setPage] = useState('home');
        const [dialog, setDialog] = useState({ open: false, game: null });
        const [bet, setBet] = useState(50);
        const [mode, setMode] = useState('amateur');
        const [activeGame, setActiveGame] = useState(null);
        const [answer, setAnswer] = useState('');
        const [mcOptions, setMcOptions] = useState([]);
        const [feedback, setFeedback] = useState(null);
        const [timerStart, setTimerStart] = useState(null);
        const [tipsUsed, setTipsUsed] = useState([]);
        const [tipHints, setTipHints] = useState({});
        const [reversePrompt, setReversePrompt] = useState(null);

        // Loading state
        useEffect(() => {
          const timer = setTimeout(() => setIsLoading(false), 300);
          return () => clearTimeout(timer);
        }, []);

        // persist settings/economy/stats
        useEffect(() => writeLS(STORAGE_KEYS.SETTINGS, { ...settings, themeMode: theme }), [settings, theme]);
        useEffect(() => writeLS(STORAGE_KEYS.ECONOMY, economy), [economy]);
        useEffect(() => writeLS(STORAGE_KEYS.STATS, stats), [stats]);

        const handleThemeChange = (val) => setTheme(val);

        const startGameDialog = (game) => {
          setDialog({ open: true, game });
          setMode(game === 'capitals' ? 'amateur' : 'schaetzen');
          setBet(50);
        };

        const ensureBalance = (cost) => economy.balance >= cost;

        const spend = (amount) => setEconomy((e) => ({ ...e, balance: Math.max(0, e.balance - amount) }));
        const gain = (amount) => setEconomy((e) => ({ ...e, balance: e.balance + amount, highscore: Math.max(e.highscore, e.balance + amount) }));

        const createCapitalQuestion = (selectedMode) => {
          const pool = selectedMode === 'national' ? capitals.filter((c) => c.region === 'EU') : capitals;
          const entry = randomItem(pool);
          let prompt = '';
          let options = [];
          let answer = '';
          let reverseInfo = null;

          if (selectedMode === 'reverse') {
            const flip = Math.random() > 0.5;
            if (flip) {
              prompt = `Land ${entry.country} (${entry.flag}) -> Rate die Hauptstadt`;
              answer = entry.capital;
              options = shuffle([entry.capital, ...shuffle(capitals).slice(0, 3).map((x) => x.capital)]).slice(0, 4);
              reverseInfo = { flip: 'country-to-capital' };
            } else {
              prompt = `Stadt ${entry.capital} -> Welches Land?`;
              answer = entry.country;
              options = shuffle([entry.country, ...shuffle(capitals).slice(0, 3).map((x) => x.country)]).slice(0, 4);
              reverseInfo = { flip: 'capital-to-country' };
            }
          } else if (selectedMode === 'amateur' || selectedMode === 'international') {
            prompt = `Was ist die Hauptstadt von ${entry.country}?`;
            answer = entry.capital;
            options = shuffle([entry.capital, ...shuffle(capitals).filter((c) => c.country !== entry.country).slice(0, 3).map((c) => c.capital)]);
          } else if (selectedMode === 'national') {
            prompt = `EU/Europa: Hauptstadt von ${entry.country}?`;
            answer = entry.capital;
            options = shuffle([entry.capital, ...shuffle(pool).filter((c) => c.country !== entry.country).slice(0, 3).map((c) => c.capital)]);
          } else if (selectedMode === 'homomode' || selectedMode === 'pro') {
            prompt = `Tippe die Hauptstadt von ${entry.country}`;
            answer = entry.capital;
            options = [];
          }

          return { prompt, options, answer, entry, reverseInfo };
        };

        const createPopulationQuestion = (selectedMode) => {
          const pair = shuffle(populations).slice(0, 2);
          const [a, b] = pair;
          const correct = a.population > b.population ? a : b;
          const prompt = selectedMode === 'vs' ? `Wer hat mehr Leute? ${a.name} vs ${b.name}` : `Wer hat mehr Einwohner?`;
          const options = shuffle([a, b, randomItem(populations), randomItem(populations)]).slice(0, 4).map((p) => p.name);
          return { pair, correct, prompt, options };
        };

        const startGame = () => {
          if (!ensureBalance(bet)) { alert('Zu wenig Sch√ºlling, oida!'); return; }
          spend(bet);
          let gameData = null;
          if (dialog.game === 'capitals') {
            gameData = { kind: 'capitals', mode, question: createCapitalQuestion(mode), rewardBase: 100 + bet };
            if (mode === 'amateur' || mode === 'international' || mode === 'national' || mode === 'reverse') {
              setMcOptions(gameData.question.options);
            } else {
              setMcOptions([]);
            }
          } else {
            gameData = { kind: 'population', mode, question: createPopulationQuestion(mode), rewardBase: 100 + bet };
            setMcOptions(gameData.question.options);
          }
          setActiveGame(gameData);
          setDialog({ open: false, game: null });
          setAnswer('');
          setFeedback(null);
          setTimerStart(Date.now());
          setTipsUsed([]);
          setTipHints({});
          setReversePrompt(gameData.kind === 'capitals' ? gameData.question.reverseInfo : null);
          setStats((s) => ({ ...s, gamesPlayed: s.gamesPlayed + 1 }));
        };

        const handleTip = (tip) => {
          if (!ensureBalance(tip.cost)) return;
          spend(tip.cost);
          setEconomy((e) => ({ ...e, tipsBought: e.tipsBought + 1 }));
          setTipsUsed((t) => [...t, tip.key]);
          setActiveGame((g) => {
            if (!g) return g;
            if (g.kind === 'capitals') {
              if (['fifty', 'strike'].includes(tip.key) && g.question.options?.length) {
                const filtered = g.question.options.filter((opt) => opt === g.question.answer || Math.random() > 0.5).slice(0, 2);
                g = { ...g, question: { ...g.question, options: filtered } };
                setMcOptions(filtered);
              }
              if (tip.key === 'coat') setTipHints((h) => ({ ...h, coat: g.question.entry.flag }));
              if (tip.key === 'first') setTipHints((h) => ({ ...h, first: g.question.answer[0] }));
              if (tip.key === 'last') setTipHints((h) => ({ ...h, last: g.question.answer[g.question.answer.length - 1] }));
              if (tip.key === 'len') setTipHints((h) => ({ ...h, len: g.question.answer.length }));
            } else if (g.kind === 'population') {
              if (tip.key === 'area') setTipHints((h) => ({ ...h, area: g.question.pair.map((p) => `${p.name}: ${p.area.toLocaleString('de-AT')} km¬≤`) }));
              if (tip.key === 'blindpop') setTipHints((h) => ({ ...h, blindpop: g.question.pair.map((p) => p.population.toLocaleString('de-AT')) }));
            }
            return { ...g, rewardBase: Math.max(20, g.rewardBase - 20) };
          });
        };

        const submitAnswer = (value) => {
          if (!activeGame) return;
          const elapsed = timerStart ? (Date.now() - timerStart) / 1000 : 0;
          const timeBonus = Math.max(0, settings.timeLimit - elapsed);
          const bonusValue = Math.round((timeBonus / settings.timeLimit) * 40);
          let correct = false;

          if (activeGame.kind === 'capitals') {
            correct = value.trim().toLowerCase() === activeGame.question.answer.trim().toLowerCase();
          } else {
            const chosen = populations.find((p) => p.name === value);
            correct = chosen && chosen.name === activeGame.question.correct.name;
          }

          if (correct) {
            const payout = activeGame.rewardBase + bonusValue;
            gain(payout);
            setStats((s) => ({ ...s, wins: s.wins + 1, timeBonus: s.timeBonus + bonusValue, lastWin: new Date().toISOString() }));
            setFeedback({ type: 'success', msg: `Jo eh, passt! +${currency(payout)}`, bonusValue });
          } else {
            const correctAnswer = activeGame.kind === 'capitals' ? activeGame.question.answer : activeGame.question.correct.name;
            setFeedback({ type: 'error', msg: `Na oida, des war nix. Richtig w√§re: ${correctAnswer}` });
          }
          setActiveGame(null);
          setTimeout(() => setFeedback(null), 5000);
        };

        const buyChoicesHomomode = () => {
          const cost = 100;
          if (!ensureBalance(cost)) return alert('Zu wenig Sch√ºlling!');
          spend(cost);
          setEconomy((e) => ({ ...e, tipsBought: e.tipsBought + 1 }));
          if (activeGame?.kind === 'capitals') {
            const opts = shuffle([activeGame.question.answer, ...shuffle(capitals).slice(0, 3).map((c) => c.capital)]);
            setMcOptions(opts);
          }
        };

        const resetAll = () => {
          setEconomy(defaultEconomy);
          setSettings(defaultSettings);
          setStats(defaultStats);
          localStorage.clear();
        };

        const pages = {
          home: 'home', games: 'games', stats: 'stats', settings: 'settings'
        };

        const navigate = (key) => {
          setPage(key);
          const el = document.getElementById(key);
          if (el) el.scrollIntoView({ behavior: 'smooth' });
        };

        const menuItems = [
          { label: 'Startseite', icon: 'üè†', onClick: () => navigate('home') },
          { label: 'Spiele-Liste', icon: 'üéÆ', onClick: () => navigate('games') },
          { label: 'Einstellungen', icon: '‚öôÔ∏è', onClick: () => navigate('settings') },
          { label: 'Statistik', icon: 'üìä', onClick: () => navigate('stats') },
          { label: resolved === 'dark' ? 'Light Mode' : 'Dark Mode', icon: 'üåì', onClick: () => handleThemeChange(resolved === 'dark' ? 'light' : 'dark') },
          { label: 'Infos', icon: '‚ÑπÔ∏è', onClick: () => alert('Raten OIDA ‚Äì Cyber-Quiz aus Wien. Version 1.0') },
        ];

        const renderActiveGame = () => {
          if (!activeGame) return null;
          const { kind, question } = activeGame;
          return (
            <div className="bg-slate-900/80 border border-white/10 rounded-2xl p-4 shadow-2xl">
              <div className="flex items-start gap-3 mb-3">
                <Badge>{kind === 'capitals' ? 'Hauptst√§dte OIDA' : 'Einwohner-Showdown'}</Badge>
                <Badge>{mode}</Badge>
              </div>
              <div className="text-lg font-semibold text-white mb-2">{question.prompt}</div>
              {reversePrompt && <div className="text-sm text-cyan-200">Reverse Mode aktiv</div>}
              <div className="space-y-3">
                {mcOptions?.length > 0 ? (
                  <div className="grid grid-cols-1 sm:grid-cols-2 gap-2">
                    {mcOptions.map((opt) => (
                      <button
                        key={opt}
                        onClick={() => submitAnswer(opt)}
                        className="px-3 py-3 rounded-xl bg-slate-800/80 border border-white/10 hover:border-neon text-left"
                      >
                        {opt}
                      </button>
                    ))}
                  </div>
                ) : (
                  <div className="flex gap-2">
                    <input 
                      value={answer} 
                      onChange={(e) => setAnswer(e.target.value)} 
                      onKeyDown={(e) => e.key === 'Enter' && submitAnswer(answer)}
                      placeholder="schreib was gscheits..." 
                      className="flex-1 px-3 py-3 rounded-xl bg-slate-800/80 border border-white/10 text-white" 
                      autoFocus
                      aria-label="Antwort eingeben"
                    />
                    <button onClick={() => submitAnswer(answer)} className="px-4 py-3 rounded-xl bg-gradient-to-r from-neon to-magenta text-slate-900 font-semibold" aria-label="Antwort absenden">Passt</button>
                  </div>
                )}
              </div>
              {kind === 'capitals' && mode === 'homomode' && mcOptions.length === 0 && (
                <button onClick={buyChoicesHomomode} className="mt-3 text-sm text-cyan-200 underline">4 Antworten kaufen (100 Sch√ºlling)</button>
              )}
              <div className="mt-3 text-sm text-slate-200">Aktueller Wert: {currency(activeGame.rewardBase)}</div>
              <div className="mt-3 text-xs text-slate-400">Zeitlimit: {settings.timeLimit}s ¬∑ Schwierigkeit: {settings.difficulty}</div>
              <div className="mt-3">
                {kind === 'capitals' ? (
                  <CapitalTips applyTip={handleTip} balance={economy.balance} />
                ) : (
                  <PopulationTips applyTip={handleTip} balance={economy.balance} />
                )}
              </div>
              <div className="mt-3 flex flex-wrap gap-2 text-cyan-200 text-sm">
                {tipHints.coat && <Badge>Wappen: {tipHints.coat}</Badge>}
                {tipHints.first && <Badge>Erster Buchstabe: {tipHints.first}</Badge>}
                {tipHints.last && <Badge>Letzter Buchstabe: {tipHints.last}</Badge>}
                {tipHints.len && <Badge>L√§nge: {tipHints.len}</Badge>}
                {tipHints.area && tipHints.area.map((a) => <Badge key={a}>{a}</Badge>)}
                {tipHints.blindpop && <Badge>Blind: {tipHints.blindpop.join(' | ')}</Badge>}
              </div>
            </div>
          );
        };

        if (isLoading) {
          return (
            <div className="min-h-screen bg-cyber2 flex items-center justify-center">
              <motion.div
                initial={{ opacity: 0, scale: 0.8 }}
                animate={{ opacity: 1, scale: 1 }}
                transition={{ duration: 0.5 }}
                className="text-center"
              >
                <Logo />
                <motion.div
                  className="mt-4 flex gap-2 justify-center"
                  initial={{ opacity: 0 }}
                  animate={{ opacity: 1 }}
                  transition={{ delay: 0.2 }}
                >
                  <span className="w-2 h-2 bg-neon rounded-full animate-pulse" style={{ animationDelay: '0ms' }}></span>
                  <span className="w-2 h-2 bg-magenta rounded-full animate-pulse" style={{ animationDelay: '150ms' }}></span>
                  <span className="w-2 h-2 bg-lime rounded-full animate-pulse" style={{ animationDelay: '300ms' }}></span>
                </motion.div>
              </motion.div>
            </div>
          );
        }

        return (
          <div className="relative min-h-screen text-slate-100">
            <div className="absolute inset-0 bg-mesh opacity-60 pointer-events-none"></div>
            <header className="sticky top-0 z-30 backdrop-blur bg-slate-950/70 border-b border-white/5">
              <div className="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
                <BurgerMenu open={burgerOpen} setOpen={setBurgerOpen} items={menuItems} />
                <Logo />
                <div className="flex items-center gap-2">
                  <Badge>{resolved === 'dark' ? 'Dark' : 'Light'} Mode</Badge>
                  <span className="text-sm text-slate-300">Kontostand: {currency(economy.balance)}</span>
                </div>
              </div>
            </header>

            <main className="max-w-6xl mx-auto px-4 py-6">
              <Section title="Start" id="home">
                <div className="grid md:grid-cols-[2fr,1fr] gap-4 items-center">
                  <div>
                    <p className="text-slate-300 mb-4">Servas! Raten OIDA ist dein cyberpunkiges Quiz mit Sch√ºlling-W√§hrung. Hol dir Zeitbonus, nutz Tipps oder zock auf Risiko.</p>
                    <div className="flex flex-wrap gap-3">
                      <button onClick={() => navigate('games')} className="px-4 py-3 rounded-xl bg-gradient-to-r from-neon to-magenta text-slate-900 font-semibold shadow-neon">Spiel starten</button>
                      <button onClick={() => navigate('settings')} className="px-4 py-3 rounded-xl border border-white/20 text-white">Einstellungen</button>
                    </div>
                  </div>
                  <motion.div
                    className="bg-slate-900/70 border border-white/10 rounded-2xl p-4 shadow-2xl"
                    initial={{ opacity: 0, scale: 0.92 }}
                    animate={{ opacity: 1, scale: 1 }}
                    transition={{ delay: 0.1 }}
                  >
                    <div className="text-sm text-slate-400 mb-2">Quick Stats</div>
                    <div className="grid grid-cols-2 gap-3 text-sm">
                      <div className="bg-slate-800/60 p-3 rounded-xl border border-white/5">
                        <div className="text-slate-400">Highscore</div>
                        <div className="text-white text-lg">{currency(economy.highscore)}</div>
                      </div>
                      <div className="bg-slate-800/60 p-3 rounded-xl border border-white/5">
                        <div className="text-slate-400">Zeitbonus</div>
                        <div className="text-white text-lg">{stats.timeBonus}</div>
                      </div>
                      <div className="bg-slate-800/60 p-3 rounded-xl border border-white/5">
                        <div className="text-slate-400">Wins</div>
                        <div className="text-white text-lg">{stats.wins}</div>
                      </div>
                      <div className="bg-slate-800/60 p-3 rounded-xl border border-white/5">
                        <div className="text-slate-400">Games</div>
                        <div className="text-white text-lg">{stats.gamesPlayed}</div>
                      </div>
                    </div>
                  </motion.div>
                </div>
              </Section>

              <Section title="Spiele" id="games">
                <div className="grid md:grid-cols-2 gap-4">
                  <GameCard
                    title="Hauptst√§dte OIDA"
                    subtitle="International, National, Reverse, Homo & Pro"
                    accent="Quiz"
                    pills={['50/50', 'Wappen', 'Erster/Letzter Buchstabe', 'Reverse Mode']}
                    onStart={() => startGameDialog('capitals')}
                  />
                  <GameCard
                    title="Einwohner Showdown"
                    subtitle="Sch√§tzen & VS Mode (Land vs Stadt)"
                    accent="Sch√ºlling Battle"
                    pills={['Wer hat mehr?', 'Fl√§che Tipp', 'Blind-Population']}
                    onStart={() => startGameDialog('population')}
                  />
                </div>
              </Section>

              {activeGame && (
                <Section title="Aktives Spiel">
                  {renderActiveGame()}
                </Section>
              )}

              <AnimatePresence>
                {feedback && (
                  <motion.div
                    initial={{ opacity: 0, y: -20 }}
                    animate={{ opacity: 1, y: 0 }}
                    exit={{ opacity: 0, y: -20 }}
                  >
                    <Section title="Ergebnis">
                      <div className={`p-4 rounded-xl border ${feedback.type === 'success' ? 'border-neon bg-neon/10' : 'border-magenta bg-magenta/10'}`}>
                        <div className={`text-lg font-semibold ${feedback.type === 'success' ? 'text-neon' : 'text-magenta'}`}>
                          {feedback.type === 'success' ? '‚úì ' : '‚úó '}{feedback.msg}
                        </div>
                        {feedback.bonusValue > 0 && (
                          <div className="text-sm text-cyan-200 mt-2">Zeitbonus: +{feedback.bonusValue} Sch√ºlling üöÄ</div>
                        )}
                      </div>
                    </Section>
                  </motion.div>
                )}
              </AnimatePresence>

              <Section title="Statistik" id="stats">
                <div className="grid md:grid-cols-3 gap-3 text-sm">
                  <div className="bg-slate-800/60 p-4 rounded-xl border border-white/10">
                    <div className="text-slate-400">Highscore</div>
                    <div className="text-white text-2xl">{currency(economy.highscore)}</div>
                  </div>
                  <div className="bg-slate-800/60 p-4 rounded-xl border border-white/10">
                    <div className="text-slate-400">Gewonnen</div>
                    <div className="text-white text-2xl">{stats.wins}</div>
                  </div>
                  <div className="bg-slate-800/60 p-4 rounded-xl border border-white/10">
                    <div className="text-slate-400">Spiele</div>
                    <div className="text-white text-2xl">{stats.gamesPlayed}</div>
                  </div>
                </div>
              </Section>

              <Section title="Einstellungen" id="settings">
                <div className="space-y-4">
                  <div className="flex flex-wrap gap-3 items-center">
                    <span className="text-sm text-slate-300">Theme</span>
                    <button onClick={() => handleThemeChange('dark')} className={`px-3 py-2 rounded-lg border ${theme === 'dark' ? 'border-neon text-neon' : 'border-white/10'}`}>Dark</button>
                    <button onClick={() => handleThemeChange('light')} className={`px-3 py-2 rounded-lg border ${theme === 'light' ? 'border-neon text-neon' : 'border-white/10'}`}>Light</button>
                    <button onClick={() => handleThemeChange('auto')} className={`px-3 py-2 rounded-lg border ${theme === 'auto' ? 'border-neon text-neon' : 'border-white/10'}`}>Auto</button>
                  </div>
                  <div className="flex flex-wrap gap-3 items-center">
                    <span className="text-sm text-slate-300">Bottom Nav sichtbar</span>
                    <input type="checkbox" checked={settings.bottomNavVisible} onChange={(e) => setSettings((s) => ({ ...s, bottomNavVisible: e.target.checked }))} />
                    <span className="text-sm text-slate-300">Gr√∂√üe</span>
                    <input type="range" min="0.8" max="1.3" step="0.05" value={settings.bottomNavScale} onChange={(e) => setSettings((s) => ({ ...s, bottomNavScale: parseFloat(e.target.value) }))} />
                  </div>
                  <div className="flex flex-wrap gap-3 items-center text-sm text-slate-300">
                    <span>Zeitlimit: {settings.timeLimit}s</span>
                    <input type="range" min="10" max="60" step="5" value={settings.timeLimit} onChange={(e) => setSettings((s) => ({ ...s, timeLimit: parseInt(e.target.value, 10) }))} />
                    <span>Schwierigkeit</span>
                    <select value={settings.difficulty} onChange={(e) => setSettings((s) => ({ ...s, difficulty: e.target.value }))} className="bg-slate-800 border border-white/10 rounded-lg px-2 py-1">
                      <option value="easy">Leiwand</option>
                      <option value="normal">Normal</option>
                      <option value="hard">Oasch schwer</option>
                    </select>
                  </div>
                </div>
              </Section>

              <Section title="Dev Tools">
                <div className="grid md:grid-cols-2 gap-3 text-sm">
                  <div className="bg-slate-800/60 p-4 rounded-xl border border-white/10 space-y-2">
                    <div className="text-slate-300">Sch√ºlling Cheats</div>
                    <button onClick={() => gain(500)} className="px-3 py-2 rounded-lg bg-slate-900 border border-neon text-neon">+500 Sch√ºlling</button>
                    <button onClick={resetAll} className="px-3 py-2 rounded-lg bg-slate-900 border border-magenta text-magenta">Alles resetten</button>
                  </div>
                  <div className="bg-slate-800/60 p-4 rounded-xl border border-white/10 space-y-2">
                    <div className="text-slate-300">localStorage</div>
                    <div className="bg-slate-900/80 rounded-lg p-2 h-32 overflow-auto text-xs text-cyan-100 whitespace-pre-wrap">{JSON.stringify({ economy, settings, stats }, null, 2)}</div>
                  </div>
                </div>
              </Section>
            </main>

            <BottomNav visible={settings.bottomNavVisible} scale={settings.bottomNavScale} onNavigate={navigate} />

            <Modal open={dialog.open} onClose={() => setDialog({ open: false, game: null })} title="Spiel konfigurieren">
              <div className="space-y-4 text-sm">
                <div className="flex flex-wrap gap-2">
                  {dialog.game === 'capitals' ? (
                    <>
                      <button onClick={() => setMode('amateur')} className={`px-3 py-2 rounded-lg border ${mode === 'amateur' ? 'border-neon text-neon' : 'border-white/10'}`}>Amateur (4 Antworten)</button>
                      <button onClick={() => setMode('homomode')} className={`px-3 py-2 rounded-lg border ${mode === 'homomode' ? 'border-neon text-neon' : 'border-white/10'}`}>Homomode (Text)</button>
                      <button onClick={() => setMode('pro')} className={`px-3 py-2 rounded-lg border ${mode === 'pro' ? 'border-neon text-neon' : 'border-white/10'}`}>Pro (Text)</button>
                      <button onClick={() => setMode('reverse')} className={`px-3 py-2 rounded-lg border ${mode === 'reverse' ? 'border-neon text-neon' : 'border-white/10'}`}>Reverse</button>
                      <button onClick={() => setMode('national')} className={`px-3 py-2 rounded-lg border ${mode === 'national' ? 'border-neon text-neon' : 'border-white/10'}`}>National (EU)</button>
                    </>
                  ) : (
                    <>
                      <button onClick={() => setMode('schaetzen')} className={`px-3 py-2 rounded-lg border ${mode === 'schaetzen' ? 'border-neon text-neon' : 'border-white/10'}`}>Sch√§tzen</button>
                      <button onClick={() => setMode('vs')} className={`px-3 py-2 rounded-lg border ${mode === 'vs' ? 'border-neon text-neon' : 'border-white/10'}`}>VS Mode</button>
                    </>
                  )}
                </div>
                <div>
                  <div className="text-slate-300 mb-1">Wetteinsatz: {bet} Sch√ºlling</div>
                  <input type="range" min="0" max="300" step="10" value={bet} onChange={(e) => setBet(parseInt(e.target.value, 10))} className="w-full" />
                </div>
                <button onClick={startGame} className="w-full px-4 py-3 rounded-xl bg-gradient-to-r from-neon to-magenta text-slate-900 font-semibold">Weiter</button>
              </div>
            </Modal>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<ErrorBoundary><App /></ErrorBoundary>);
    })();
  </script>
</body>
</html>
