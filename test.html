<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raten OIDA - Test Suite</title>
    <style>
        body {
            font-family: monospace;
            background: #1a1a1a;
            color: #00ff88;
            padding: 2rem;
            line-height: 1.6;
        }
        .test-section {
            background: #252525;
            border: 2px solid #00ff88;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        .success { color: #00ff88; }
        .error { color: #ff006e; }
        .info { color: #00d9ff; }
        button {
            background: linear-gradient(135deg, #00ff88 0%, #00d9ff 100%);
            color: #1a1a1a;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin: 0.5rem 0.5rem 0.5rem 0;
        }
        button:hover {
            transform: scale(1.05);
        }
        #results {
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>ğŸ® Raten OIDA - Test Suite</h1>
    
    <div class="test-section">
        <h2>Automatische Tests</h2>
        <button onclick="runAllTests()">ğŸš€ Alle Tests ausfÃ¼hren</button>
        <button onclick="testModules()">ğŸ“¦ Module testen</button>
        <button onclick="testStore()">ğŸ’¾ Store testen</button>
        <button onclick="testRouter()">ğŸ—ºï¸ Router testen</button>
        <button onclick="testGames()">ğŸ® Spiele testen</button>
        <button onclick="clearResults()">ğŸ—‘ï¸ LÃ¶schen</button>
    </div>

    <div class="test-section">
        <h2>Manuelle Tests</h2>
        <a href="/index.html" target="_blank">
            <button>ğŸŒ App Ã¶ffnen</button>
        </a>
        <button onclick="window.location.href='http://localhost:8000'">ğŸ”„ Server neu laden</button>
    </div>

    <div class="test-section">
        <h2>Test Ergebnisse</h2>
        <div id="results"></div>
    </div>

    <script type="module">
        import { store } from './js/core/store.js';
        import { router } from './js/core/router.js';
        import { $, createElement, shuffle } from './js/core/dom.js';
        import { capitalsData } from './js/data/capitals.js';
        import { populationData } from './js/data/population.js';

        window.testModules = testModules;
        window.testStore = testStore;
        window.testRouter = testRouter;
        window.testGames = testGames;
        window.runAllTests = runAllTests;
        window.clearResults = clearResults;

        const results = document.getElementById('results');

        function log(message, type = 'info') {
            const span = document.createElement('div');
            span.className = type;
            span.textContent = message;
            results.appendChild(span);
        }

        function clearResults() {
            results.innerHTML = '';
        }

        async function testModules() {
            log('=== MODULE TESTS ===\n', 'info');
            
            try {
                log('âœ“ store.js importiert', 'success');
                log('âœ“ router.js importiert', 'success');
                log('âœ“ dom.js importiert', 'success');
                log('âœ“ capitals.js importiert', 'success');
                log('âœ“ population.js importiert', 'success');
                
                log(`\nDaten geladen:`, 'info');
                log(`  - ${capitalsData.length} HauptstÃ¤dte`, 'info');
                log(`  - ${populationData.length} StÃ¤dte (Population)`, 'info');
                
                log('\nâœ“ Alle Module erfolgreich geladen!\n', 'success');
            } catch (e) {
                log(`âœ— Fehler beim Laden: ${e.message}`, 'error');
            }
        }

        async function testStore() {
            log('=== STORE TESTS ===\n', 'info');
            
            try {
                // Wallet Test
                const initialWallet = store.getWallet();
                log(`Initial Wallet: ${initialWallet} SchÃ¼lling`, 'info');
                
                store.addSchuelling(100);
                log(`âœ“ +100 SchÃ¼lling hinzugefÃ¼gt`, 'success');
                
                const paid = store.paySchuelling(50);
                if (paid) {
                    log(`âœ“ 50 SchÃ¼lling bezahlt`, 'success');
                } else {
                    log(`âœ— Zahlung fehlgeschlagen`, 'error');
                }
                
                // Settings Test
                const theme = store.getSetting('theme');
                log(`\nAktuelles Theme: ${theme}`, 'info');
                
                store.toggleTheme();
                const newTheme = store.getSetting('theme');
                log(`âœ“ Theme gewechselt zu: ${newTheme}`, 'success');
                
                store.toggleTheme(); // ZurÃ¼ck
                log(`âœ“ Theme zurÃ¼ckgesetzt zu: ${store.getSetting('theme')}`, 'success');
                
                // Stats Test
                const stats = store.getStats();
                log(`\nStatistiken:`, 'info');
                log(`  - Spiele gespielt: ${stats.gamesPlayed}`, 'info');
                log(`  - Highscore: ${stats.highScore}`, 'info');
                
                log('\nâœ“ Store funktioniert korrekt!\n', 'success');
            } catch (e) {
                log(`âœ— Store Fehler: ${e.message}`, 'error');
            }
        }

        async function testRouter() {
            log('=== ROUTER TESTS ===\n', 'info');
            
            try {
                log(`Registrierte Routen: home, game-select, stats, settings`, 'info');
                log(`Aktuelle Route: ${router.currentRoute}`, 'info');
                
                log('\nâœ“ Router initialisiert!\n', 'success');
            } catch (e) {
                log(`âœ— Router Fehler: ${e.message}`, 'error');
            }
        }

        async function testGames() {
            log('=== GAME TESTS ===\n', 'info');
            
            try {
                // Test Capitals Data
                const easyCapitals = capitalsData.filter(c => c.difficulty === 'easy');
                const mediumCapitals = capitalsData.filter(c => c.difficulty === 'medium');
                const hardCapitals = capitalsData.filter(c => c.difficulty === 'hard');
                
                log(`HauptstÃ¤dte nach Schwierigkeit:`, 'info');
                log(`  - Leicht: ${easyCapitals.length}`, 'info');
                log(`  - Mittel: ${mediumCapitals.length}`, 'info');
                log(`  - Schwer: ${hardCapitals.length}`, 'info');
                
                // Test Population Data
                const sortedCities = [...populationData].sort((a, b) => b.population - a.population);
                log(`\nGrÃ¶ÃŸte StÃ¤dte:`, 'info');
                sortedCities.slice(0, 3).forEach((city, i) => {
                    log(`  ${i+1}. ${city.city} (${(city.population / 1000000).toFixed(1)} Mio.)`, 'info');
                });
                
                // Test Shuffle
                const testArray = [1, 2, 3, 4, 5];
                const shuffled = shuffle(testArray);
                log(`\nShuffle Test: [${testArray}] â†’ [${shuffled}]`, 'info');
                log(`âœ“ Shuffle funktioniert`, 'success');
                
                log('\nâœ“ Game Daten korrekt!\n', 'success');
            } catch (e) {
                log(`âœ— Game Fehler: ${e.message}`, 'error');
            }
        }

        async function runAllTests() {
            clearResults();
            log('ğŸ® RATEN OIDA - KOMPLETTE TEST SUITE\n', 'info');
            log('='.repeat(50) + '\n', 'info');
            
            await testModules();
            await testStore();
            await testRouter();
            await testGames();
            
            log('='.repeat(50), 'info');
            log('\nğŸ‰ ALLE TESTS ABGESCHLOSSEN!\n', 'success');
            log('Die App ist bereit zum Spielen! ğŸ¯', 'success');
        }

        // Auto-run on load
        log('Test Suite geladen. Klicke "Alle Tests ausfÃ¼hren" um zu starten.\n', 'info');
    </script>
</body>
</html>
